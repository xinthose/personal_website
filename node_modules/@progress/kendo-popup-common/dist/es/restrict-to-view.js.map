{"version":3,"file":"restrict-to-view.js","sources":["restrict-to-view.js"],"sourcesContent":["import alignPoint from './align-point';\nimport collision from './collision';\n\nconst fit = function(position, size, viewPortSize) {\n    let output = 0;\n\n    if (position + size > viewPortSize) {\n        output = viewPortSize - (position + size);\n    }\n\n    if (position < 0) {\n        output = -position;\n    }\n\n    return output;\n};\n\nconst flip = function({ offset, size, anchorSize, viewPortSize, anchorAlignPoint, elementAlignPoint }) {\n    let output = 0;\n\n    const isPositionCentered = elementAlignPoint === alignPoint.center || elementAlignPoint === alignPoint.middle;\n    const isOriginCentered = anchorAlignPoint === alignPoint.center || anchorAlignPoint === alignPoint.middle;\n\n    if (elementAlignPoint !== anchorAlignPoint && !isPositionCentered && !isOriginCentered && offset > -1) {\n        if (offset + size > viewPortSize) {\n            output += -(anchorSize + size);\n        }\n\n        if (offset + output < 0) {\n            output += anchorSize + size;\n        }\n    }\n    return output;\n};\n\nconst restrictToView = (options) => {\n    const { anchorRect, anchorAlign, elementRect, elementAlign, collisions, viewPort } = options;\n    const { top: elementTop, left: elementLeft, height: elementHeight, width: elementWidth } = elementRect;\n    const { height: viewPortHeight, width: viewPortWidth } = viewPort;\n\n    let left = 0;\n    let top = 0;\n\n    const isHorizontalFlip = collisions.horizontal === collision.flip;\n    const isVerticalFlip = collisions.vertical === collision.flip;\n\n    if (collisions.vertical === collision.fit) {\n        top += fit(elementTop, elementHeight, viewPortHeight);\n    }\n\n    if (collisions.horizontal === collision.fit) {\n        left += fit(elementLeft, elementWidth, viewPortWidth);\n    }\n\n    if (isVerticalFlip) {\n        top += flip({\n            offset: elementTop,\n            size: elementHeight,\n            anchorSize: anchorRect.height,\n            viewPortSize: viewPortHeight,\n            anchorAlignPoint: anchorAlign.vertical,\n            elementAlignPoint: elementAlign.vertical\n        });\n    }\n\n    if (isHorizontalFlip) {\n        left += flip({\n            offset: elementLeft,\n            size: elementWidth,\n            anchorSize: anchorRect.width,\n            viewPortSize: viewPortWidth,\n            anchorAlignPoint: anchorAlign.horizontal,\n            elementAlignPoint: elementAlign.horizontal\n        });\n    }\n\n    return {\n        flipped: (isHorizontalFlip && left !== 0) || (isVerticalFlip && top !== 0),\n        offset: {\n            left: left,\n            top: top\n        }\n    };\n};\n\nexport default restrictToView;\n"],"names":["const","let"],"mappings":"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"}