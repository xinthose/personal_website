'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var alignPoint = {
    "bottom": "bottom",
    "center": "center",
    "middle": "middle",
    "left": "left",
    "right": "right",
    "top": "top"
};

var align = function (options) {
    var anchorRect = options.anchorRect;
    var anchorAlign = options.anchorAlign;
    var elementRect = options.elementRect;
    var elementAlign = options.elementAlign;
    var margin = options.margin; if ( margin === void 0 ) margin = {};
    var anchorHorizontal = anchorAlign.horizontal;
    var anchorVertical = anchorAlign.vertical;
    var elementHorizontal = elementAlign.horizontal;
    var elementVertical = elementAlign.vertical;

    var horizontalMargin = margin.horizontal || 0;
    var verticalMargin = margin.vertical || 0;

    var top = anchorRect.top;
    var left = anchorRect.left;

    if (anchorVertical === alignPoint.bottom) {
        top += anchorRect.height;
    }

    if (anchorVertical === alignPoint.center || anchorVertical === alignPoint.middle) {
        top += Math.round(anchorRect.height / 2);
    }

    if (elementVertical === alignPoint.bottom) {
        top -= elementRect.height;
        verticalMargin *= -1;
    }

    if (elementVertical === alignPoint.center || elementVertical === alignPoint.middle) {
        top -= Math.round(elementRect.height / 2);
        verticalMargin *= -1;
    }

    if (anchorHorizontal === alignPoint.right) {
        left += anchorRect.width;
    }

    if (anchorHorizontal === alignPoint.center || anchorHorizontal === alignPoint.middle) {
        left += Math.round(anchorRect.width / 2);
    }

    if (elementHorizontal === alignPoint.right) {
        left -= elementRect.width;
        horizontalMargin *= -1;
    }

    if (elementHorizontal === alignPoint.center || elementHorizontal === alignPoint.middle) {
        left -= Math.round(elementRect.width / 2);
        horizontalMargin *= -1;
    }

    return {
        top: top + verticalMargin,
        left: left + horizontalMargin
    };
};

function addScroll(rect, scroll) {
    return {
        top: rect.top + scroll.y,
        left: rect.left + scroll.x,
        height: rect.height,
        width: rect.width
    };
}

function applyLocationOffset(rect, location, isOffsetBody) {
    var top = rect.top;
    var left = rect.left;

    if (isOffsetBody) {
        left = 0;
        top = 0;
    }

    return {
        top: top + location.top,
        left: left + location.left,
        height: rect.height,
        width: rect.width
    };
}

var boundingOffset = function (element) {
    if (!element.getBoundingClientRect) {
        return {
            bottom: element.innerHeight,
            left: 0,
            right: element.innerWidth,
            top: 0
        };
    }

    var ref = element.getBoundingClientRect();
    var bottom = ref.bottom;
    var left = ref.left;
    var right = ref.right;
    var top = ref.top;

    return {
        bottom: bottom,
        left: left,
        right: right,
        top: top
    };
};

var getDocument = function (element) { return ( element.ownerDocument.documentElement ); };

var offsetParent = function (element) {
    var offsetParent = element.offsetParent;

    while (offsetParent && offsetParent.style.position === "static") {
        offsetParent = offsetParent.offsetParent;
    }

    return offsetParent || getDocument(element);
};

var isBodyOffset = function (element) { return (offsetParent(element) === element.ownerDocument.body); };

var rectOfHiddenElement = function (element) {
    var ref = element.style;
    var display = ref.display;
    var left = ref.left;
    var position = ref.position;

    element.style.display = '';
    element.style.left = '-10000px';
    element.style.position = 'absolute';

    var rect = element.getBoundingClientRect();

    element.style.display = display;
    element.style.left = left;
    element.style.position = position;

    return rect;
};

var offset = function (element) {
    var rect = element.getBoundingClientRect();
    var left = rect.left;
    var top = rect.top;

    if (!rect.height && !rect.width) {
        rect = rectOfHiddenElement(element);
    }

    return {
        top: top,
        left: left,
        height: rect.height,
        width: rect.width
    };
};

var parents = function (element, until) {
    var result = [];
    var next = element.parentNode;

    while (next) {
        result.push(next);

        if (next === until) { break; }

        next = next.parentNode;
    }

    return result;
};

var getWindow = function (element) { return ( element.ownerDocument.defaultView ); };

function scrollPosition(element) {
    var documentElement = getDocument(element);
    var win = getWindow(element);

    return {
        x: win.pageXOffset || documentElement.scrollLeft || 0,
        y: win.pageYOffset || documentElement.scrollTop || 0
    };
}

var elementScrollPosition = function (element) {
    if (element === (element.ownerDocument || {}).body) {
        return scrollPosition(element);
    }

    return {
        x: element.scrollLeft,
        y: element.scrollTop
    };
};

function parentScrollPosition(element) {
    var parent = offsetParent(element);

    return parent ? elementScrollPosition(parent) : { x: 0, y: 0 };
}

var position = function (element, parent) {
    var win = getWindow(element);
    var elementStyles = win.getComputedStyle(element);
    var offset$$1 = offset(element);
    var parentElement = parent || offsetParent(element);

    var ownerDocument = element.ownerDocument;
    var useRelative = parentElement !== ownerDocument.body && parentElement !== ownerDocument.documentElement;

    var parentOffset = { top: 0, left: 0 };

    if (elementStyles.position !== "fixed" && useRelative) {
        var parentStyles = win.getComputedStyle(parentElement);

        parentOffset = offset(parentElement);
        parentOffset.top += parseInt(parentStyles.borderTopWidth, 10);
        parentOffset.left += parseInt(parentStyles.borderLeftWidth, 10);
    }

    return {
        top: offset$$1.top - parentOffset.top - parseInt(elementStyles.marginTop, 10),
        left: offset$$1.left - parentOffset.left - parseInt(elementStyles.marginLeft, 10),
        height: offset$$1.height,
        width: offset$$1.width
    };
};

var offsetParentScrollPosition = function (offsetParentElement, element) { return ( // eslint-disable-line no-arrow-condition
    offsetParentElement ? elementScrollPosition(offsetParentElement) : parentScrollPosition(element)
); };

var positionWithScroll = function (element, parent) {
    var offsetParentElement = parent ? offsetParent(parent) : null;
    var ref = position(element, offsetParentElement);
    var top = ref.top;
    var left = ref.left;
    var height = ref.height;
    var width = ref.width;
    var ref$1 = offsetParentScrollPosition(offsetParentElement, element);
    var x = ref$1.x;
    var y = ref$1.y;

    return {
        top: top + y,
        left: left + x,
        height: height,
        width: width
    };
};

function removeScroll(rect, scroll) {
    return {
        top: rect.top - scroll.y,
        left: rect.left - scroll.x,
        height: rect.height,
        width: rect.width
    };
}

var collision = {
    "fit": "fit",
    "flip": "flip"
};

var fit = function(position, size, viewPortSize) {
    var output = 0;

    if (position + size > viewPortSize) {
        output = viewPortSize - (position + size);
    }

    if (position < 0) {
        output = -position;
    }

    return output;
};

var flip = function(ref) {
    var offset = ref.offset;
    var size = ref.size;
    var anchorSize = ref.anchorSize;
    var viewPortSize = ref.viewPortSize;
    var anchorAlignPoint = ref.anchorAlignPoint;
    var elementAlignPoint = ref.elementAlignPoint;
    var margin = ref.margin;

    var output = 0;

    var isPositionCentered = elementAlignPoint === alignPoint.center || elementAlignPoint === alignPoint.middle;
    var isOriginCentered = anchorAlignPoint === alignPoint.center || anchorAlignPoint === alignPoint.middle;
    var marginToAdd = 2 * margin; //2x to keep margin after flip

    if (elementAlignPoint !== anchorAlignPoint && !isPositionCentered && !isOriginCentered && offset > -1) {
        if (offset + size > viewPortSize) {
            output += -(anchorSize + size + marginToAdd);
        }

        if (offset + output < 0) {
            output = 0; //skip flip
        }
    }

    return output;
};

var restrictToView = function (options) {
    var anchorRect = options.anchorRect;
    var anchorAlign = options.anchorAlign;
    var elementRect = options.elementRect;
    var elementAlign = options.elementAlign;
    var collisions = options.collisions;
    var viewPort = options.viewPort;
    var margin = options.margin; if ( margin === void 0 ) margin = {};
    var elementTop = elementRect.top;
    var elementLeft = elementRect.left;
    var elementHeight = elementRect.height;
    var elementWidth = elementRect.width;
    var viewPortHeight = viewPort.height;
    var viewPortWidth = viewPort.width;
    var horizontalMargin = margin.horizontal || 0;
    var verticalMargin = margin.vertical || 0;

    var left = 0;
    var top = 0;

    var isHorizontalFlip = collisions.horizontal === collision.flip;
    var isVerticalFlip = collisions.vertical === collision.flip;

    if (collisions.vertical === collision.fit) {
        top += fit(elementTop, elementHeight, viewPortHeight);
    }

    if (collisions.horizontal === collision.fit) {
        left += fit(elementLeft, elementWidth, viewPortWidth);
    }

    if (isVerticalFlip) {
        top += flip({
            margin: verticalMargin,
            offset: elementTop,
            size: elementHeight,
            anchorSize: anchorRect.height,
            viewPortSize: viewPortHeight,
            anchorAlignPoint: anchorAlign.vertical,
            elementAlignPoint: elementAlign.vertical
        });
    }

    if (isHorizontalFlip) {
        left += flip({
            margin: horizontalMargin,
            offset: elementLeft,
            size: elementWidth,
            anchorSize: anchorRect.width,
            viewPortSize: viewPortWidth,
            anchorAlignPoint: anchorAlign.horizontal,
            elementAlignPoint: elementAlign.horizontal
        });
    }
    var flippedHorizontal = isHorizontalFlip && left !== 0;
    var flippedVertical = isVerticalFlip && top !== 0;

    return {
        flipped: flippedHorizontal || flippedVertical,
        flip: {
            horizontal: flippedHorizontal,
            vertical: flippedVertical
        },
        offset: {
            left: left,
            top: top
        }
    };
};

var siblings = function (element) {
    var result = [];

    var sibling = element.parentNode.firstElementChild;

    while (sibling) {
        if (sibling !== element) {
            result.push(sibling);
        }

        sibling = sibling.nextElementSibling;
    }
    return result;
};

/* eslint-disable no-loop-func */

var siblingContainer = function (anchor, container) {
    var parentElements = parents(anchor);
    var containerElement = container;
    var siblingElements;
    var result;

    while (containerElement) {
        siblingElements = siblings(containerElement);

        result = parentElements.reduce(
            function (list, p) { return list.concat(siblingElements.filter(function (s) { return s === p; })); },
            []
        )[0];

        if (result) { break; }

        containerElement = containerElement.parentElement;
    }

    return result;
};

function windowViewport(element) {
    var win = getWindow(element);

    return {
        height: win.innerHeight,
        width: win.innerWidth
    };
}

exports.align = align;
exports.addScroll = addScroll;
exports.applyLocationOffset = applyLocationOffset;
exports.boundingOffset = boundingOffset;
exports.isBodyOffset = isBodyOffset;
exports.offsetParent = offsetParent;
exports.offset = offset;
exports.parents = parents;
exports.parentScrollPosition = parentScrollPosition;
exports.position = position;
exports.positionWithScroll = positionWithScroll;
exports.removeScroll = removeScroll;
exports.restrictToView = restrictToView;
exports.scrollPosition = scrollPosition;
exports.siblingContainer = siblingContainer;
exports.siblings = siblings;
exports.getDocumentElement = getDocument;
exports.getWindow = getWindow;
exports.getWindowViewPort = windowViewport;
exports.AlignPoint = alignPoint;
exports.Collision = collision;

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi91c3IvbG9jYWwvamVua2lucy93b3Jrc3BhY2Uva2VuZG8tcG9wdXAtY29tbW9uX3JlbGVhc2Uvc3JjL2FsaWduLXBvaW50LmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvYWxpZ24uanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9hZGQtc2Nyb2xsLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvYXBwbHktbG9jYXRpb24tb2Zmc2V0LmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvYm91bmRpbmctb2Zmc2V0LmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvZG9jdW1lbnQuanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9vZmZzZXQtcGFyZW50LmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvaXMtYm9keS1vZmZzZXQuanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9vZmZzZXQuanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9wYXJlbnRzLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvd2luZG93LmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvc2Nyb2xsLXBvc2l0aW9uLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvZWxlbWVudC1zY3JvbGwtcG9zaXRpb24uanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9wYXJlbnQtc2Nyb2xsLXBvc2l0aW9uLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvcG9zaXRpb24uanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9vZmZzZXQtcGFyZW50LXNjcm9sbC1wb3NpdGlvbi5qcyIsIi91c3IvbG9jYWwvamVua2lucy93b3Jrc3BhY2Uva2VuZG8tcG9wdXAtY29tbW9uX3JlbGVhc2Uvc3JjL3Bvc2l0aW9uLXdpdGgtc2Nyb2xsLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvcmVtb3ZlLXNjcm9sbC5qcyIsIi91c3IvbG9jYWwvamVua2lucy93b3Jrc3BhY2Uva2VuZG8tcG9wdXAtY29tbW9uX3JlbGVhc2Uvc3JjL2NvbGxpc2lvbi5qcyIsIi91c3IvbG9jYWwvamVua2lucy93b3Jrc3BhY2Uva2VuZG8tcG9wdXAtY29tbW9uX3JlbGVhc2Uvc3JjL3Jlc3RyaWN0LXRvLXZpZXcuanMiLCIvdXNyL2xvY2FsL2plbmtpbnMvd29ya3NwYWNlL2tlbmRvLXBvcHVwLWNvbW1vbl9yZWxlYXNlL3NyYy9zaWJsaW5ncy5qcyIsIi91c3IvbG9jYWwvamVua2lucy93b3Jrc3BhY2Uva2VuZG8tcG9wdXAtY29tbW9uX3JlbGVhc2Uvc3JjL3NpYmxpbmctY29udGFpbmVyLmpzIiwiL3Vzci9sb2NhbC9qZW5raW5zL3dvcmtzcGFjZS9rZW5kby1wb3B1cC1jb21tb25fcmVsZWFzZS9zcmMvd2luZG93LXZpZXdwb3J0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IHtcbiAgICBcImJvdHRvbVwiOiBcImJvdHRvbVwiLFxuICAgIFwiY2VudGVyXCI6IFwiY2VudGVyXCIsXG4gICAgXCJtaWRkbGVcIjogXCJtaWRkbGVcIixcbiAgICBcImxlZnRcIjogXCJsZWZ0XCIsXG4gICAgXCJyaWdodFwiOiBcInJpZ2h0XCIsXG4gICAgXCJ0b3BcIjogXCJ0b3BcIlxufTtcbiIsImltcG9ydCBwb2ludCBmcm9tICcuL2FsaWduLXBvaW50JztcblxuY29uc3QgYWxpZ24gPSAob3B0aW9ucykgPT4ge1xuICAgIGNvbnN0IHsgYW5jaG9yUmVjdCwgYW5jaG9yQWxpZ24sIGVsZW1lbnRSZWN0LCBlbGVtZW50QWxpZ24sIG1hcmdpbiA9IHt9IH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IGFuY2hvckhvcml6b250YWwgPSBhbmNob3JBbGlnbi5ob3Jpem9udGFsO1xuICAgIGNvbnN0IGFuY2hvclZlcnRpY2FsID0gYW5jaG9yQWxpZ24udmVydGljYWw7XG4gICAgY29uc3QgZWxlbWVudEhvcml6b250YWwgPSBlbGVtZW50QWxpZ24uaG9yaXpvbnRhbDtcbiAgICBjb25zdCBlbGVtZW50VmVydGljYWwgPSBlbGVtZW50QWxpZ24udmVydGljYWw7XG5cbiAgICBsZXQgaG9yaXpvbnRhbE1hcmdpbiA9IG1hcmdpbi5ob3Jpem9udGFsIHx8IDA7XG4gICAgbGV0IHZlcnRpY2FsTWFyZ2luID0gbWFyZ2luLnZlcnRpY2FsIHx8IDA7XG5cbiAgICBsZXQgdG9wID0gYW5jaG9yUmVjdC50b3A7XG4gICAgbGV0IGxlZnQgPSBhbmNob3JSZWN0LmxlZnQ7XG5cbiAgICBpZiAoYW5jaG9yVmVydGljYWwgPT09IHBvaW50LmJvdHRvbSkge1xuICAgICAgICB0b3AgKz0gYW5jaG9yUmVjdC5oZWlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKGFuY2hvclZlcnRpY2FsID09PSBwb2ludC5jZW50ZXIgfHwgYW5jaG9yVmVydGljYWwgPT09IHBvaW50Lm1pZGRsZSkge1xuICAgICAgICB0b3AgKz0gTWF0aC5yb3VuZChhbmNob3JSZWN0LmhlaWdodCAvIDIpO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50VmVydGljYWwgPT09IHBvaW50LmJvdHRvbSkge1xuICAgICAgICB0b3AgLT0gZWxlbWVudFJlY3QuaGVpZ2h0O1xuICAgICAgICB2ZXJ0aWNhbE1hcmdpbiAqPSAtMTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudFZlcnRpY2FsID09PSBwb2ludC5jZW50ZXIgfHwgZWxlbWVudFZlcnRpY2FsID09PSBwb2ludC5taWRkbGUpIHtcbiAgICAgICAgdG9wIC09IE1hdGgucm91bmQoZWxlbWVudFJlY3QuaGVpZ2h0IC8gMik7XG4gICAgICAgIHZlcnRpY2FsTWFyZ2luICo9IC0xO1xuICAgIH1cblxuICAgIGlmIChhbmNob3JIb3Jpem9udGFsID09PSBwb2ludC5yaWdodCkge1xuICAgICAgICBsZWZ0ICs9IGFuY2hvclJlY3Qud2lkdGg7XG4gICAgfVxuXG4gICAgaWYgKGFuY2hvckhvcml6b250YWwgPT09IHBvaW50LmNlbnRlciB8fCBhbmNob3JIb3Jpem9udGFsID09PSBwb2ludC5taWRkbGUpIHtcbiAgICAgICAgbGVmdCArPSBNYXRoLnJvdW5kKGFuY2hvclJlY3Qud2lkdGggLyAyKTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudEhvcml6b250YWwgPT09IHBvaW50LnJpZ2h0KSB7XG4gICAgICAgIGxlZnQgLT0gZWxlbWVudFJlY3Qud2lkdGg7XG4gICAgICAgIGhvcml6b250YWxNYXJnaW4gKj0gLTE7XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnRIb3Jpem9udGFsID09PSBwb2ludC5jZW50ZXIgfHwgZWxlbWVudEhvcml6b250YWwgPT09IHBvaW50Lm1pZGRsZSkge1xuICAgICAgICBsZWZ0IC09IE1hdGgucm91bmQoZWxlbWVudFJlY3Qud2lkdGggLyAyKTtcbiAgICAgICAgaG9yaXpvbnRhbE1hcmdpbiAqPSAtMTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IHRvcCArIHZlcnRpY2FsTWFyZ2luLFxuICAgICAgICBsZWZ0OiBsZWZ0ICsgaG9yaXpvbnRhbE1hcmdpblxuICAgIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhbGlnbjtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGFkZFNjcm9sbChyZWN0LCBzY3JvbGwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IHJlY3QudG9wICsgc2Nyb2xsLnksXG4gICAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHNjcm9sbC54LFxuICAgICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0LFxuICAgICAgICB3aWR0aDogcmVjdC53aWR0aFxuICAgIH07XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhcHBseUxvY2F0aW9uT2Zmc2V0KHJlY3QsIGxvY2F0aW9uLCBpc09mZnNldEJvZHkpIHtcbiAgICBsZXQgeyB0b3AsIGxlZnQgfSA9IHJlY3Q7XG5cbiAgICBpZiAoaXNPZmZzZXRCb2R5KSB7XG4gICAgICAgIGxlZnQgPSAwO1xuICAgICAgICB0b3AgPSAwO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogdG9wICsgbG9jYXRpb24udG9wLFxuICAgICAgICBsZWZ0OiBsZWZ0ICsgbG9jYXRpb24ubGVmdCxcbiAgICAgICAgaGVpZ2h0OiByZWN0LmhlaWdodCxcbiAgICAgICAgd2lkdGg6IHJlY3Qud2lkdGhcbiAgICB9O1xufVxuIiwiY29uc3QgYm91bmRpbmdPZmZzZXQgPSAoZWxlbWVudCkgPT4ge1xuICAgIGlmICghZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJvdHRvbTogZWxlbWVudC5pbm5lckhlaWdodCxcbiAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICByaWdodDogZWxlbWVudC5pbm5lcldpZHRoLFxuICAgICAgICAgICAgdG9wOiAwXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgeyBib3R0b20sIGxlZnQsIHJpZ2h0LCB0b3AgfSA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBib3R0b20sXG4gICAgICAgIGxlZnQsXG4gICAgICAgIHJpZ2h0LFxuICAgICAgICB0b3BcbiAgICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYm91bmRpbmdPZmZzZXQ7XG4iLCJjb25zdCBnZXREb2N1bWVudCA9IChlbGVtZW50KSA9PiAoIGVsZW1lbnQub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgKTtcblxuZXhwb3J0IGRlZmF1bHQgZ2V0RG9jdW1lbnQ7XG4iLCJpbXBvcnQgZG9jdW1lbnRFbGVtZW50IGZyb20gJy4vZG9jdW1lbnQnO1xuXG5jb25zdCBvZmZzZXRQYXJlbnQgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCBvZmZzZXRQYXJlbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcblxuICAgIHdoaWxlIChvZmZzZXRQYXJlbnQgJiYgb2Zmc2V0UGFyZW50LnN0eWxlLnBvc2l0aW9uID09PSBcInN0YXRpY1wiKSB7XG4gICAgICAgIG9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudC5vZmZzZXRQYXJlbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9mZnNldFBhcmVudCB8fCBkb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBvZmZzZXRQYXJlbnQ7XG4iLCJpbXBvcnQgb2Zmc2V0UGFyZW50IGZyb20gJy4vb2Zmc2V0LXBhcmVudCc7XG5cbmNvbnN0IGlzQm9keU9mZnNldCA9IChlbGVtZW50KSA9PiAob2Zmc2V0UGFyZW50KGVsZW1lbnQpID09PSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuYm9keSk7XG5cbmV4cG9ydCBkZWZhdWx0IGlzQm9keU9mZnNldDtcbiIsImNvbnN0IHJlY3RPZkhpZGRlbkVsZW1lbnQgPSAoZWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHsgZGlzcGxheSwgbGVmdCwgcG9zaXRpb24gfSA9IGVsZW1lbnQuc3R5bGU7XG5cbiAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSAnLTEwMDAwcHgnO1xuICAgIGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuXG4gICAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xuICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQ7XG4gICAgZWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuXG4gICAgcmV0dXJuIHJlY3Q7XG59O1xuXG5jb25zdCBvZmZzZXQgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBsZXQgeyBsZWZ0LCB0b3AgfSA9IHJlY3Q7XG5cbiAgICBpZiAoIXJlY3QuaGVpZ2h0ICYmICFyZWN0LndpZHRoKSB7XG4gICAgICAgIHJlY3QgPSByZWN0T2ZIaWRkZW5FbGVtZW50KGVsZW1lbnQpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogdG9wLFxuICAgICAgICBsZWZ0OiBsZWZ0LFxuICAgICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0LFxuICAgICAgICB3aWR0aDogcmVjdC53aWR0aFxuICAgIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBvZmZzZXQ7XG4iLCJleHBvcnQgZGVmYXVsdCAoZWxlbWVudCwgdW50aWwpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBsZXQgbmV4dCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcblxuICAgIHdoaWxlIChuZXh0KSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKG5leHQpO1xuXG4gICAgICAgIGlmIChuZXh0ID09PSB1bnRpbCkgeyBicmVhazsgfVxuXG4gICAgICAgIG5leHQgPSBuZXh0LnBhcmVudE5vZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJjb25zdCBnZXRXaW5kb3cgPSAoZWxlbWVudCkgPT4gKCBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgKTtcblxuZXhwb3J0IGRlZmF1bHQgZ2V0V2luZG93O1xuIiwiaW1wb3J0IGRvY0VsZW1lbnQgZnJvbSAnLi9kb2N1bWVudCc7XG5pbXBvcnQgd25kIGZyb20gJy4vd2luZG93JztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc2Nyb2xsUG9zaXRpb24oZWxlbWVudCkge1xuICAgIGNvbnN0IGRvY3VtZW50RWxlbWVudCA9IGRvY0VsZW1lbnQoZWxlbWVudCk7XG4gICAgY29uc3Qgd2luID0gd25kKGVsZW1lbnQpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogd2luLnBhZ2VYT2Zmc2V0IHx8IGRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0IHx8IDAsXG4gICAgICAgIHk6IHdpbi5wYWdlWU9mZnNldCB8fCBkb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IDBcbiAgICB9O1xufVxuIiwiaW1wb3J0IHNjcm9sbFBvc2l0aW9uIGZyb20gJy4vc2Nyb2xsLXBvc2l0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgKGVsZW1lbnQpID0+IHtcbiAgICBpZiAoZWxlbWVudCA9PT0gKGVsZW1lbnQub3duZXJEb2N1bWVudCB8fCB7fSkuYm9keSkge1xuICAgICAgICByZXR1cm4gc2Nyb2xsUG9zaXRpb24oZWxlbWVudCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgICAgICB5OiBlbGVtZW50LnNjcm9sbFRvcFxuICAgIH07XG59O1xuIiwiaW1wb3J0IG9mZnNldFBhcmVudCBmcm9tICcuL29mZnNldC1wYXJlbnQnO1xuaW1wb3J0IGVsZW1lbnRTY3JvbGxQb3NpdGlvbiBmcm9tICcuL2VsZW1lbnQtc2Nyb2xsLXBvc2l0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcGFyZW50U2Nyb2xsUG9zaXRpb24oZWxlbWVudCkge1xuICAgIGNvbnN0IHBhcmVudCA9IG9mZnNldFBhcmVudChlbGVtZW50KTtcblxuICAgIHJldHVybiBwYXJlbnQgPyBlbGVtZW50U2Nyb2xsUG9zaXRpb24ocGFyZW50KSA6IHsgeDogMCwgeTogMCB9O1xufVxuIiwiaW1wb3J0IG9mZnNldFBhcmVudCBmcm9tICcuL29mZnNldC1wYXJlbnQnO1xuaW1wb3J0IG9mZnNldFJlY3QgZnJvbSAnLi9vZmZzZXQnO1xuaW1wb3J0IHduZCBmcm9tICcuL3dpbmRvdyc7XG5cbmNvbnN0IHBvc2l0aW9uID0gKGVsZW1lbnQsIHBhcmVudCkgPT4ge1xuICAgIGNvbnN0IHdpbiA9IHduZChlbGVtZW50KTtcbiAgICBjb25zdCBlbGVtZW50U3R5bGVzID0gd2luLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gICAgY29uc3Qgb2Zmc2V0ID0gb2Zmc2V0UmVjdChlbGVtZW50KTtcbiAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gcGFyZW50IHx8IG9mZnNldFBhcmVudChlbGVtZW50KTtcblxuICAgIGNvbnN0IG93bmVyRG9jdW1lbnQgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgY29uc3QgdXNlUmVsYXRpdmUgPSBwYXJlbnRFbGVtZW50ICE9PSBvd25lckRvY3VtZW50LmJvZHkgJiYgcGFyZW50RWxlbWVudCAhPT0gb3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cbiAgICBsZXQgcGFyZW50T2Zmc2V0ID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcblxuICAgIGlmIChlbGVtZW50U3R5bGVzLnBvc2l0aW9uICE9PSBcImZpeGVkXCIgJiYgdXNlUmVsYXRpdmUpIHtcbiAgICAgICAgY29uc3QgcGFyZW50U3R5bGVzID0gd2luLmdldENvbXB1dGVkU3R5bGUocGFyZW50RWxlbWVudCk7XG5cbiAgICAgICAgcGFyZW50T2Zmc2V0ID0gb2Zmc2V0UmVjdChwYXJlbnRFbGVtZW50KTtcbiAgICAgICAgcGFyZW50T2Zmc2V0LnRvcCArPSBwYXJzZUludChwYXJlbnRTdHlsZXMuYm9yZGVyVG9wV2lkdGgsIDEwKTtcbiAgICAgICAgcGFyZW50T2Zmc2V0LmxlZnQgKz0gcGFyc2VJbnQocGFyZW50U3R5bGVzLmJvcmRlckxlZnRXaWR0aCwgMTApO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogb2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AgLSBwYXJzZUludChlbGVtZW50U3R5bGVzLm1hcmdpblRvcCwgMTApLFxuICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0IC0gcGFyc2VJbnQoZWxlbWVudFN0eWxlcy5tYXJnaW5MZWZ0LCAxMCksXG4gICAgICAgIGhlaWdodDogb2Zmc2V0LmhlaWdodCxcbiAgICAgICAgd2lkdGg6IG9mZnNldC53aWR0aFxuICAgIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBwb3NpdGlvbjtcbiIsImltcG9ydCBlbGVtZW50U2Nyb2xsUG9zaXRpb24gZnJvbSAnLi9lbGVtZW50LXNjcm9sbC1wb3NpdGlvbic7XG5pbXBvcnQgcGFyZW50U2Nyb2xsUG9zaXRpb24gZnJvbSAnLi9wYXJlbnQtc2Nyb2xsLXBvc2l0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgKG9mZnNldFBhcmVudEVsZW1lbnQsIGVsZW1lbnQpID0+ICggLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1hcnJvdy1jb25kaXRpb25cbiAgICBvZmZzZXRQYXJlbnRFbGVtZW50ID8gZWxlbWVudFNjcm9sbFBvc2l0aW9uKG9mZnNldFBhcmVudEVsZW1lbnQpIDogcGFyZW50U2Nyb2xsUG9zaXRpb24oZWxlbWVudClcbik7XG4iLCJpbXBvcnQgb2Zmc2V0UGFyZW50U2Nyb2xsUG9zaXRpb24gZnJvbSAnLi9vZmZzZXQtcGFyZW50LXNjcm9sbC1wb3NpdGlvbic7XG5pbXBvcnQgb2Zmc2V0UGFyZW50IGZyb20gJy4vb2Zmc2V0LXBhcmVudCc7XG5pbXBvcnQgcG9zaXRpb24gZnJvbSAnLi9wb3NpdGlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IChlbGVtZW50LCBwYXJlbnQpID0+IHtcbiAgICBjb25zdCBvZmZzZXRQYXJlbnRFbGVtZW50ID0gcGFyZW50ID8gb2Zmc2V0UGFyZW50KHBhcmVudCkgOiBudWxsO1xuICAgIGNvbnN0IHsgdG9wLCBsZWZ0LCBoZWlnaHQsIHdpZHRoIH0gPSBwb3NpdGlvbihlbGVtZW50LCBvZmZzZXRQYXJlbnRFbGVtZW50KTtcbiAgICBjb25zdCB7IHgsIHkgfSA9IG9mZnNldFBhcmVudFNjcm9sbFBvc2l0aW9uKG9mZnNldFBhcmVudEVsZW1lbnQsIGVsZW1lbnQpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiB0b3AgKyB5LFxuICAgICAgICBsZWZ0OiBsZWZ0ICsgeCxcbiAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgIHdpZHRoOiB3aWR0aFxuICAgIH07XG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVtb3ZlU2Nyb2xsKHJlY3QsIHNjcm9sbCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogcmVjdC50b3AgLSBzY3JvbGwueSxcbiAgICAgICAgbGVmdDogcmVjdC5sZWZ0IC0gc2Nyb2xsLngsXG4gICAgICAgIGhlaWdodDogcmVjdC5oZWlnaHQsXG4gICAgICAgIHdpZHRoOiByZWN0LndpZHRoXG4gICAgfTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IHtcbiAgICBcImZpdFwiOiBcImZpdFwiLFxuICAgIFwiZmxpcFwiOiBcImZsaXBcIlxufTtcbiIsImltcG9ydCBhbGlnblBvaW50IGZyb20gJy4vYWxpZ24tcG9pbnQnO1xuaW1wb3J0IGNvbGxpc2lvbiBmcm9tICcuL2NvbGxpc2lvbic7XG5cbmNvbnN0IGZpdCA9IGZ1bmN0aW9uKHBvc2l0aW9uLCBzaXplLCB2aWV3UG9ydFNpemUpIHtcbiAgICBsZXQgb3V0cHV0ID0gMDtcblxuICAgIGlmIChwb3NpdGlvbiArIHNpemUgPiB2aWV3UG9ydFNpemUpIHtcbiAgICAgICAgb3V0cHV0ID0gdmlld1BvcnRTaXplIC0gKHBvc2l0aW9uICsgc2l6ZSk7XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uIDwgMCkge1xuICAgICAgICBvdXRwdXQgPSAtcG9zaXRpb247XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dHB1dDtcbn07XG5cbmNvbnN0IGZsaXAgPSBmdW5jdGlvbih7IG9mZnNldCwgc2l6ZSwgYW5jaG9yU2l6ZSwgdmlld1BvcnRTaXplLCBhbmNob3JBbGlnblBvaW50LCBlbGVtZW50QWxpZ25Qb2ludCwgbWFyZ2luIH0pIHtcbiAgICBsZXQgb3V0cHV0ID0gMDtcblxuICAgIGNvbnN0IGlzUG9zaXRpb25DZW50ZXJlZCA9IGVsZW1lbnRBbGlnblBvaW50ID09PSBhbGlnblBvaW50LmNlbnRlciB8fCBlbGVtZW50QWxpZ25Qb2ludCA9PT0gYWxpZ25Qb2ludC5taWRkbGU7XG4gICAgY29uc3QgaXNPcmlnaW5DZW50ZXJlZCA9IGFuY2hvckFsaWduUG9pbnQgPT09IGFsaWduUG9pbnQuY2VudGVyIHx8IGFuY2hvckFsaWduUG9pbnQgPT09IGFsaWduUG9pbnQubWlkZGxlO1xuICAgIGNvbnN0IG1hcmdpblRvQWRkID0gMiAqIG1hcmdpbjsgLy8yeCB0byBrZWVwIG1hcmdpbiBhZnRlciBmbGlwXG5cbiAgICBpZiAoZWxlbWVudEFsaWduUG9pbnQgIT09IGFuY2hvckFsaWduUG9pbnQgJiYgIWlzUG9zaXRpb25DZW50ZXJlZCAmJiAhaXNPcmlnaW5DZW50ZXJlZCAmJiBvZmZzZXQgPiAtMSkge1xuICAgICAgICBpZiAob2Zmc2V0ICsgc2l6ZSA+IHZpZXdQb3J0U2l6ZSkge1xuICAgICAgICAgICAgb3V0cHV0ICs9IC0oYW5jaG9yU2l6ZSArIHNpemUgKyBtYXJnaW5Ub0FkZCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob2Zmc2V0ICsgb3V0cHV0IDwgMCkge1xuICAgICAgICAgICAgb3V0cHV0ID0gMDsgLy9za2lwIGZsaXBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvdXRwdXQ7XG59O1xuXG5jb25zdCByZXN0cmljdFRvVmlldyA9IChvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgeyBhbmNob3JSZWN0LCBhbmNob3JBbGlnbiwgZWxlbWVudFJlY3QsIGVsZW1lbnRBbGlnbiwgY29sbGlzaW9ucywgdmlld1BvcnQsIG1hcmdpbiA9IHt9IH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHsgdG9wOiBlbGVtZW50VG9wLCBsZWZ0OiBlbGVtZW50TGVmdCwgaGVpZ2h0OiBlbGVtZW50SGVpZ2h0LCB3aWR0aDogZWxlbWVudFdpZHRoIH0gPSBlbGVtZW50UmVjdDtcbiAgICBjb25zdCB7IGhlaWdodDogdmlld1BvcnRIZWlnaHQsIHdpZHRoOiB2aWV3UG9ydFdpZHRoIH0gPSB2aWV3UG9ydDtcbiAgICBjb25zdCBob3Jpem9udGFsTWFyZ2luID0gbWFyZ2luLmhvcml6b250YWwgfHwgMDtcbiAgICBjb25zdCB2ZXJ0aWNhbE1hcmdpbiA9IG1hcmdpbi52ZXJ0aWNhbCB8fCAwO1xuXG4gICAgbGV0IGxlZnQgPSAwO1xuICAgIGxldCB0b3AgPSAwO1xuXG4gICAgY29uc3QgaXNIb3Jpem9udGFsRmxpcCA9IGNvbGxpc2lvbnMuaG9yaXpvbnRhbCA9PT0gY29sbGlzaW9uLmZsaXA7XG4gICAgY29uc3QgaXNWZXJ0aWNhbEZsaXAgPSBjb2xsaXNpb25zLnZlcnRpY2FsID09PSBjb2xsaXNpb24uZmxpcDtcblxuICAgIGlmIChjb2xsaXNpb25zLnZlcnRpY2FsID09PSBjb2xsaXNpb24uZml0KSB7XG4gICAgICAgIHRvcCArPSBmaXQoZWxlbWVudFRvcCwgZWxlbWVudEhlaWdodCwgdmlld1BvcnRIZWlnaHQpO1xuICAgIH1cblxuICAgIGlmIChjb2xsaXNpb25zLmhvcml6b250YWwgPT09IGNvbGxpc2lvbi5maXQpIHtcbiAgICAgICAgbGVmdCArPSBmaXQoZWxlbWVudExlZnQsIGVsZW1lbnRXaWR0aCwgdmlld1BvcnRXaWR0aCk7XG4gICAgfVxuXG4gICAgaWYgKGlzVmVydGljYWxGbGlwKSB7XG4gICAgICAgIHRvcCArPSBmbGlwKHtcbiAgICAgICAgICAgIG1hcmdpbjogdmVydGljYWxNYXJnaW4sXG4gICAgICAgICAgICBvZmZzZXQ6IGVsZW1lbnRUb3AsXG4gICAgICAgICAgICBzaXplOiBlbGVtZW50SGVpZ2h0LFxuICAgICAgICAgICAgYW5jaG9yU2l6ZTogYW5jaG9yUmVjdC5oZWlnaHQsXG4gICAgICAgICAgICB2aWV3UG9ydFNpemU6IHZpZXdQb3J0SGVpZ2h0LFxuICAgICAgICAgICAgYW5jaG9yQWxpZ25Qb2ludDogYW5jaG9yQWxpZ24udmVydGljYWwsXG4gICAgICAgICAgICBlbGVtZW50QWxpZ25Qb2ludDogZWxlbWVudEFsaWduLnZlcnRpY2FsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChpc0hvcml6b250YWxGbGlwKSB7XG4gICAgICAgIGxlZnQgKz0gZmxpcCh7XG4gICAgICAgICAgICBtYXJnaW46IGhvcml6b250YWxNYXJnaW4sXG4gICAgICAgICAgICBvZmZzZXQ6IGVsZW1lbnRMZWZ0LFxuICAgICAgICAgICAgc2l6ZTogZWxlbWVudFdpZHRoLFxuICAgICAgICAgICAgYW5jaG9yU2l6ZTogYW5jaG9yUmVjdC53aWR0aCxcbiAgICAgICAgICAgIHZpZXdQb3J0U2l6ZTogdmlld1BvcnRXaWR0aCxcbiAgICAgICAgICAgIGFuY2hvckFsaWduUG9pbnQ6IGFuY2hvckFsaWduLmhvcml6b250YWwsXG4gICAgICAgICAgICBlbGVtZW50QWxpZ25Qb2ludDogZWxlbWVudEFsaWduLmhvcml6b250YWxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGZsaXBwZWRIb3Jpem9udGFsID0gaXNIb3Jpem9udGFsRmxpcCAmJiBsZWZ0ICE9PSAwO1xuICAgIGNvbnN0IGZsaXBwZWRWZXJ0aWNhbCA9IGlzVmVydGljYWxGbGlwICYmIHRvcCAhPT0gMDtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGZsaXBwZWQ6IGZsaXBwZWRIb3Jpem9udGFsIHx8IGZsaXBwZWRWZXJ0aWNhbCxcbiAgICAgICAgZmxpcDoge1xuICAgICAgICAgICAgaG9yaXpvbnRhbDogZmxpcHBlZEhvcml6b250YWwsXG4gICAgICAgICAgICB2ZXJ0aWNhbDogZmxpcHBlZFZlcnRpY2FsXG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDoge1xuICAgICAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgICAgIHRvcDogdG9wXG4gICAgICAgIH1cbiAgICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgcmVzdHJpY3RUb1ZpZXc7XG4iLCJleHBvcnQgZGVmYXVsdCAoZWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuXG4gICAgbGV0IHNpYmxpbmcgPSBlbGVtZW50LnBhcmVudE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbiAgICB3aGlsZSAoc2libGluZykge1xuICAgICAgICBpZiAoc2libGluZyAhPT0gZWxlbWVudCkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goc2libGluZyk7XG4gICAgICAgIH1cblxuICAgICAgICBzaWJsaW5nID0gc2libGluZy5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuIiwiLyogZXNsaW50LWRpc2FibGUgbm8tbG9vcC1mdW5jICovXG5cbmltcG9ydCBwYXJlbnRzIGZyb20gJy4vcGFyZW50cyc7XG5pbXBvcnQgc2libGluZ3MgZnJvbSAnLi9zaWJsaW5ncyc7XG5cbmV4cG9ydCBkZWZhdWx0IChhbmNob3IsIGNvbnRhaW5lcikgPT4ge1xuICAgIGNvbnN0IHBhcmVudEVsZW1lbnRzID0gcGFyZW50cyhhbmNob3IpO1xuICAgIGxldCBjb250YWluZXJFbGVtZW50ID0gY29udGFpbmVyO1xuICAgIGxldCBzaWJsaW5nRWxlbWVudHM7XG4gICAgbGV0IHJlc3VsdDtcblxuICAgIHdoaWxlIChjb250YWluZXJFbGVtZW50KSB7XG4gICAgICAgIHNpYmxpbmdFbGVtZW50cyA9IHNpYmxpbmdzKGNvbnRhaW5lckVsZW1lbnQpO1xuXG4gICAgICAgIHJlc3VsdCA9IHBhcmVudEVsZW1lbnRzLnJlZHVjZShcbiAgICAgICAgICAgIChsaXN0LCBwKSA9PiBsaXN0LmNvbmNhdChzaWJsaW5nRWxlbWVudHMuZmlsdGVyKHMgPT4gcyA9PT0gcCkpLFxuICAgICAgICAgICAgW11cbiAgICAgICAgKVswXTtcblxuICAgICAgICBpZiAocmVzdWx0KSB7IGJyZWFrOyB9XG5cbiAgICAgICAgY29udGFpbmVyRWxlbWVudCA9IGNvbnRhaW5lckVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuIiwiaW1wb3J0IHduZCBmcm9tICcuL3dpbmRvdyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHdpbmRvd1ZpZXdwb3J0KGVsZW1lbnQpIHtcbiAgICBjb25zdCB3aW4gPSB3bmQoZWxlbWVudCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBoZWlnaHQ6IHdpbi5pbm5lckhlaWdodCxcbiAgICAgICAgd2lkdGg6IHdpbi5pbm5lcldpZHRoXG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6WyJjb25zdCIsImxldCIsInBvaW50IiwiZG9jdW1lbnRFbGVtZW50IiwiZG9jRWxlbWVudCIsInduZCIsIm9mZnNldCIsIm9mZnNldFJlY3QiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpQkFBZTtJQUNYLFFBQVEsRUFBRSxRQUFRO0lBQ2xCLFFBQVEsRUFBRSxRQUFRO0lBQ2xCLFFBQVEsRUFBRSxRQUFRO0lBQ2xCLE1BQU0sRUFBRSxNQUFNO0lBQ2QsT0FBTyxFQUFFLE9B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